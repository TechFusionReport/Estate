<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Estate Management Center</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Lora:wght@400;600;700&family=Inter:wght@300;400;500;600&display=swap');
    
    body {
      font-family: 'Inter', sans-serif;
      margin: 0;
      padding: 0;
    }
    
    .font-serif {
      font-family: 'Lora', serif;
    }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel" data-type="module">
    const { useState, useEffect } = React;

    // Simple icon components (replacing lucide)
    const Icon = ({ children, size = 20, ...props }) => (
      <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
        {children}
      </svg>
    );

    const Plus = (props) => <Icon {...props}><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></Icon>;
    const Upload = (props) => <Icon {...props}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></Icon>;
    const CheckCircle2 = (props) => <Icon {...props}><circle cx="12" cy="12" r="10"/><path d="m9 12 2 2 4-4"/></Icon>;
    const Circle = (props) => <Icon {...props}><circle cx="12" cy="12" r="10"/></Icon>;
    const AlertCircle = (props) => <Icon {...props}><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/><line x1="12" y1="16" x2="12.01" y2="16"/></Icon>;
    const FileText = (props) => <Icon {...props}><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></Icon>;
    const Phone = (props) => <Icon {...props}><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></Icon>;
    const Mail = (props) => <Icon {...props}><rect x="2" y="4" width="20" height="16" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/></Icon>;
    const Calendar = (props) => <Icon {...props}><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></Icon>;
    const Trash2 = (props) => <Icon {...props}><polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/><line x1="10" y1="11" x2="10" y2="17"/><line x1="14" y1="11" x2="14" y2="17"/></Icon>;
    const Edit2 = (props) => <Icon {...props}><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></Icon>;
    const Save = (props) => <Icon {...props}><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></Icon>;
    const X = (props) => <Icon {...props}><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></Icon>;
    const ChevronDown = (props) => <Icon {...props}><polyline points="6 9 12 15 18 9"/></Icon>;
    const ChevronRight = (props) => <Icon {...props}><polyline points="9 18 15 12 9 6"/></Icon>;
    const Search = (props) => <Icon {...props}><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></Icon>;
    const Download = (props) => <Icon {...props}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></Icon>;

    // Storage wrapper for localStorage
    const storage = {
      get: (key) => {
        try {
          const item = localStorage.getItem(key);
          return item ? { value: item } : null;
        } catch (error) {
          console.error('Storage get error:', error);
          return null;
        }
      },
      set: (key, value) => {
        try {
          localStorage.setItem(key, value);
          return { key, value };
        } catch (error) {
          console.error('Storage set error:', error);
          return null;
        }
      }
    };

    // Main App Component
    function EstateManager() {
      const [benefits, setBenefits] = useState([]);
      const [accounts, setAccounts] = useState([]);
      const [tasks, setTasks] = useState([]);
      const [activeTab, setActiveTab] = useState('dashboard');
      const [loading, setLoading] = useState(true);
      const [filterCategory, setFilterCategory] = useState('all');
      const [searchTerm, setSearchTerm] = useState('');

      useEffect(() => {
        loadData();
      }, []);

      const loadData = () => {
        try {
          const benefitsData = storage.get('estate-benefits');
          const accountsData = storage.get('estate-accounts');
          const tasksData = storage.get('estate-tasks');

          if (benefitsData?.value) setBenefits(JSON.parse(benefitsData.value));
          if (accountsData?.value) setAccounts(JSON.parse(accountsData.value));
          if (tasksData?.value) setTasks(JSON.parse(tasksData.value));

          setLoading(false);
        } catch (error) {
          console.log('No existing data, starting fresh');
          setLoading(false);
        }
      };

      const saveData = (benefitsData, accountsData, tasksData) => {
        try {
          if (benefitsData !== null) storage.set('estate-benefits', JSON.stringify(benefitsData));
          if (accountsData !== null) storage.set('estate-accounts', JSON.stringify(accountsData));
          if (tasksData !== null) storage.set('estate-tasks', JSON.stringify(tasksData));
        } catch (error) {
          console.error('Error saving data:', error);
        }
      };

      if (loading) {
        return (
          <div className="min-h-screen bg-gradient-to-br from-amber-50 via-stone-50 to-slate-100 flex items-center justify-center">
            <div className="text-stone-600 text-lg">Loading estate information...</div>
          </div>
        );
      }

      return (
        <div className="min-h-screen bg-gradient-to-br from-amber-50 via-stone-50 to-slate-100">
          <Header />
          <Navigation activeTab={activeTab} setActiveTab={setActiveTab} />
          
          <main className="max-w-7xl mx-auto px-4 sm:px-6 py-8">
            {activeTab === 'dashboard' && (
              <Dashboard 
                benefits={benefits} 
                tasks={tasks} 
                accounts={accounts}
                setBenefits={setBenefits}
                setTasks={setTasks}
                saveData={saveData}
              />
            )}
            {activeTab === 'benefits' && (
              <BenefitsManager 
                benefits={benefits} 
                setBenefits={setBenefits}
                saveData={saveData}
                filterCategory={filterCategory}
                setFilterCategory={setFilterCategory}
                searchTerm={searchTerm}
                setSearchTerm={setSearchTerm}
              />
            )}
            {activeTab === 'accounts' && (
              <AccountsManager 
                accounts={accounts} 
                setAccounts={setAccounts}
                saveData={saveData}
                searchTerm={searchTerm}
                setSearchTerm={setSearchTerm}
              />
            )}
            {activeTab === 'import' && (
              <ImportManager 
                accounts={accounts}
                setAccounts={setAccounts}
                saveData={saveData}
              />
            )}
            {activeTab === 'guidance' && <NCGuidance />}
          </main>
        </div>
      );
    }

    // Header Component
    function Header() {
      return (
        <header className="bg-white border-b-2 border-stone-200 shadow-sm">
          <div className="max-w-7xl mx-auto px-4 sm:px-6 py-6 sm:py-8">
            <h1 className="text-2xl sm:text-4xl font-serif text-stone-800 mb-2">Estate Management Center</h1>
            <p className="text-sm sm:text-base text-stone-600 font-light">Organizing affairs with care and clarity</p>
          </div>
        </header>
      );
    }

    // Navigation Component
    function Navigation({ activeTab, setActiveTab }) {
      const tabs = [
        { id: 'dashboard', label: 'Dashboard', icon: FileText },
        { id: 'benefits', label: 'Benefits', icon: CheckCircle2 },
        { id: 'accounts', label: 'Accounts', icon: Circle },
        { id: 'import', label: 'Import', icon: Upload },
        { id: 'guidance', label: 'NC Guide', icon: AlertCircle }
      ];

      return (
        <nav className="bg-white border-b border-stone-200 sticky top-0 z-10 shadow-sm overflow-x-auto">
          <div className="max-w-7xl mx-auto px-4 sm:px-6">
            <div className="flex space-x-1">
              {tabs.map(tab => {
                const IconComponent = tab.icon;
                return (
                  <button
                    key={tab.id}
                    onClick={() => setActiveTab(tab.id)}
                    className={`flex items-center space-x-2 px-3 sm:px-6 py-3 sm:py-4 border-b-3 transition-all font-medium whitespace-nowrap text-sm sm:text-base ${
                      activeTab === tab.id
                        ? 'border-amber-600 text-amber-700 bg-amber-50'
                        : 'border-transparent text-stone-600 hover:text-stone-800 hover:bg-stone-50'
                    }`}
                  >
                    <IconComponent size={16} />
                    <span className="hidden sm:inline">{tab.label}</span>
                    <span className="sm:hidden">{tab.label.split(' ')[0]}</span>
                  </button>
                );
              })}
            </div>
          </div>
        </nav>
      );
    }

    // Dashboard Component
    function Dashboard({ benefits, tasks, accounts, setBenefits, setTasks, saveData }) {
      const completedBenefits = benefits.filter(b => b.status === 'completed').length;
      const pendingBenefits = benefits.filter(b => b.status === 'pending').length;
      const completedTasks = tasks.filter(t => t.completed).length;
      const urgentTasks = tasks.filter(t => !t.completed && t.priority === 'high').length;

      return (
        <div className="space-y-6 sm:space-y-8">
          <div className="grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-6">
            <StatCard label="Total Benefits" value={benefits.length} color="amber" />
            <StatCard label="Completed" value={completedBenefits} color="emerald" />
            <StatCard label="Pending" value={pendingBenefits} color="blue" />
            <StatCard label="Urgent Tasks" value={urgentTasks} color="rose" />
          </div>

          <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <RecentBenefits benefits={benefits} />
            <TaskList tasks={tasks} setTasks={setTasks} saveData={saveData} />
          </div>

          <QuickActions />
        </div>
      );
    }

    // Stat Card Component
    function StatCard({ label, value, color }) {
      const colorClasses = {
        amber: 'bg-gradient-to-br from-amber-500 to-orange-500',
        emerald: 'bg-gradient-to-br from-emerald-500 to-teal-500',
        blue: 'bg-gradient-to-br from-blue-500 to-indigo-500',
        rose: 'bg-gradient-to-br from-rose-500 to-pink-500'
      };

      return (
        <div className={`${colorClasses[color]} rounded-xl p-4 sm:p-6 text-white shadow-lg`}>
          <div className="text-xs sm:text-sm font-medium opacity-90 mb-1">{label}</div>
          <div className="text-2xl sm:text-4xl font-bold font-serif">{value}</div>
        </div>
      );
    }

    // Recent Benefits Component
    function RecentBenefits({ benefits }) {
      const recentBenefits = benefits.slice(0, 5);

      return (
        <div className="bg-white rounded-xl shadow-md p-4 sm:p-6 border border-stone-200">
          <h2 className="text-xl sm:text-2xl font-serif text-stone-800 mb-4">Recent Benefits</h2>
          <div className="space-y-3">
            {recentBenefits.length === 0 ? (
              <p className="text-stone-500 italic text-sm">No benefits added yet</p>
            ) : (
              recentBenefits.map(benefit => (
                <div key={benefit.id} className="flex items-center justify-between p-3 bg-stone-50 rounded-lg">
                  <div className="min-w-0 flex-1">
                    <div className="font-medium text-stone-800 text-sm sm:text-base truncate">{benefit.institution}</div>
                    <div className="text-xs sm:text-sm text-stone-600">{benefit.type}</div>
                  </div>
                  <StatusBadge status={benefit.status} />
                </div>
              ))
            )}
          </div>
        </div>
      );
    }

    // Task List Component
    function TaskList({ tasks, setTasks, saveData }) {
      const [showCompleted, setShowCompleted] = useState(false);
      const [newTask, setNewTask] = useState('');

      const displayTasks = showCompleted ? tasks : tasks.filter(t => !t.completed);

      const toggleTask = (id) => {
        const updatedTasks = tasks.map(t => 
          t.id === id ? { ...t, completed: !t.completed } : t
        );
        setTasks(updatedTasks);
        saveData(null, null, updatedTasks);
      };

      const addTask = () => {
        if (!newTask.trim()) return;
        const task = {
          id: Date.now(),
          title: newTask,
          completed: false,
          priority: 'medium',
          createdAt: new Date().toISOString()
        };
        const updatedTasks = [...tasks, task];
        setTasks(updatedTasks);
        saveData(null, null, updatedTasks);
        setNewTask('');
      };

      return (
        <div className="bg-white rounded-xl shadow-md p-4 sm:p-6 border border-stone-200">
          <div className="flex items-center justify-between mb-4">
            <h2 className="text-xl sm:text-2xl font-serif text-stone-800">Tasks</h2>
            <button
              onClick={() => setShowCompleted(!showCompleted)}
              className="text-xs sm:text-sm text-stone-600 hover:text-stone-800"
            >
              {showCompleted ? 'Hide' : 'Show'} Completed
            </button>
          </div>
          
          <div className="flex gap-2 mb-4">
            <input
              type="text"
              value={newTask}
              onChange={(e) => setNewTask(e.target.value)}
              onKeyPress={(e) => e.key === 'Enter' && addTask()}
              placeholder="Add a new task..."
              className="flex-1 px-3 sm:px-4 py-2 text-sm sm:text-base border border-stone-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-amber-500"
            />
            <button
              onClick={addTask}
              className="px-3 sm:px-4 py-2 bg-amber-600 text-white rounded-lg hover:bg-amber-700 transition-colors"
            >
              <Plus size={18} />
            </button>
          </div>

          <div className="space-y-2">
            {displayTasks.length === 0 ? (
              <p className="text-stone-500 italic text-sm">No tasks to display</p>
            ) : (
              displayTasks.map(task => (
                <div
                  key={task.id}
                  className="flex items-center gap-3 p-3 bg-stone-50 rounded-lg hover:bg-stone-100 transition-colors"
                >
                  <button
                    onClick={() => toggleTask(task.id)}
                    className="text-amber-600 hover:text-amber-700 flex-shrink-0"
                  >
                    {task.completed ? <CheckCircle2 size={18} /> : <Circle size={18} />}
                  </button>
                  <span className={`flex-1 text-sm sm:text-base ${task.completed ? 'line-through text-stone-400' : 'text-stone-800'}`}>
                    {task.title}
                  </span>
                </div>
              ))
            )}
          </div>
        </div>
      );
    }

    // Quick Actions Component
    function QuickActions() {
      return (
        <div className="bg-gradient-to-r from-slate-700 to-slate-800 rounded-xl shadow-lg p-6 sm:p-8 text-white">
          <h2 className="text-xl sm:text-2xl font-serif mb-4 sm:mb-6">Quick Actions</h2>
          <div className="grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4">
            <ActionButton icon={Plus} label="Add Death Benefit" />
            <ActionButton icon={Upload} label="Import Accounts" />
            <ActionButton icon={FileText} label="NC Estate Guide" />
          </div>
        </div>
      );
    }

    function ActionButton({ icon: IconComponent, label }) {
      return (
        <button className="flex items-center gap-3 p-3 sm:p-4 bg-white/10 rounded-lg hover:bg-white/20 transition-all border border-white/20">
          <IconComponent size={20} />
          <span className="font-medium text-sm sm:text-base">{label}</span>
        </button>
      );
    }

    // Placeholder components for other tabs (simplified for length)
    function BenefitsManager() {
      return (
        <div className="bg-white rounded-xl shadow-md p-8 border border-stone-200">
          <h2 className="text-3xl font-serif text-stone-800 mb-4">Death Benefits Tracking</h2>
          <p className="text-stone-600">Benefits management coming soon...</p>
        </div>
      );
    }

    function AccountsManager() {
      return (
        <div className="bg-white rounded-xl shadow-md p-8 border border-stone-200">
          <h2 className="text-3xl font-serif text-stone-800 mb-4">Account Management</h2>
          <p className="text-stone-600">Account management coming soon...</p>
        </div>
      );
    }

    function ImportManager() {
      return (
        <div className="bg-white rounded-xl shadow-md p-8 border border-stone-200">
          <h2 className="text-3xl font-serif text-stone-800 mb-4">Import Password Manager Data</h2>
          <p className="text-stone-600">CSV import coming soon...</p>
        </div>
      );
    }

    function NCGuidance() {
      return (
        <div className="bg-white rounded-xl shadow-md p-8 border border-stone-200">
          <h2 className="text-3xl font-serif text-stone-800 mb-4">North Carolina Estate Guidelines</h2>
          <p className="text-stone-600">State guidelines coming soon...</p>
        </div>
      );
    }

    // Utility Badge Components
    function StatusBadge({ status }) {
      const styles = {
        pending: 'bg-blue-100 text-blue-800',
        'in-progress': 'bg-amber-100 text-amber-800',
        completed: 'bg-emerald-100 text-emerald-800',
        'on-hold': 'bg-stone-100 text-stone-800'
      };

      return (
        <span className={`px-2 sm:px-3 py-1 rounded-full text-xs font-medium ${styles[status]} whitespace-nowrap`}>
          {status.split('-').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ')}
        </span>
      );
    }

    // Render the app
    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<EstateManager />);
  </script>
</body>
</html>
